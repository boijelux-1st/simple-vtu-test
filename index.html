<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>VTU.ng Admin Dashboard</title>
</head>
<body>
<h1>VTU.ng Dashboard</h1>

<section>
  <h2>Transactions</h2>
  <button onclick="fetchStatus()">Refresh</button>
  <ul id="tx"></ul>
</section>

<section>
  <h2>Recharge</h2>
  <input id="phone" placeholder="Phone">
  <input id="amount" placeholder="Amount">
  <input id="network" placeholder="Network">
  <button onclick="recharge()">Send</button>
</section>

<section>
  <h2>Update Price</h2>
  <input id="product" placeholder="Product ID">
  <input id="price" placeholder="New Price">
  <button onclick="updatePrice()">Update</button>
</section>

<script>
async function fetchStatus() {
  const res = await fetch('/api/status');
  const data = await res.json();
  const list = document.getElementById('tx');
  list.innerHTML = '';
  (data.data || []).forEach(t => {
    const li = document.createElement('li');
    li.textContent = `${t.date} - ${t.amount} - ${t.status}`;
    list.appendChild(li);
  });
}

async function recharge() {
  const phone = document.getElementById('phone').value;
  const amount = document.getElementById('amount').value;
  const network = document.getElementById('network').value;
  const res = await fetch('/api/recharge', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ phone, amount, network })
  });
  alert(await res.text());
}

async function updatePrice() {
  const product_id = document.getElementById('product').value;
  const new_price = document.getElementById('price').value;
  const res = await fetch('/api/update-price', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ product_id, new_price })
  });
  alert(await res.text());
}
</script>
</body>
</html>
